# SignalFriend - TO-DO List
# Last Updated: November 29, 2024

================================================================================
                        ‚úÖ COMPLETED
================================================================================

[‚úÖ] Smart Contracts Development
    - SignalFriendMarket.sol (Logic/Controller)
    - PredictorAccessPass.sol (Soulbound NFT)
    - SignalKeyNFT.sol (Transferable Receipt NFT)
    - MockUSDT.sol (Testnet only)

[‚úÖ] Unit Tests (96 tests - ALL PASSING)
    - SignalFriendMarket.t.sol (28 tests)
    - PredictorAccessPass.t.sol (35 tests)
    - SignalKeyNFT.t.sol (33 tests)

[‚úÖ] Deployment to BNB Testnet
    - Phase 1: Script deployment complete
    - Phase 2: MultiSig setup complete
    - isFullyInitialized() = true

[‚úÖ] Documentation
    - RUNBOOK.md (deployment & operations guide)
    - PROJECT_CONTEXT.md
    - CHANGELOG.md

================================================================================
                    üìç DEPLOYED CONTRACT ADDRESSES (BNB Testnet)
================================================================================

MockUSDT:            0xF87d17a5ca95F3f992f82Baabf4eBC5301A178a5
SignalFriendMarket:  0x5133397a4B9463c5270beBa05b22301e6dD184ca
PredictorAccessPass: 0x10EB1A238Db78b763ec97e326b800D7A7AcA3fC4
SignalKeyNFT:        0xfb26Df6101e1a52f9477f52F54b91b99fb016aed

================================================================================
                    üß™ MANUAL TESTING ON BSCSCAN (Testnet)
================================================================================

------------------------------------------------------------------------------
MOCKUSDT TESTS
------------------------------------------------------------------------------
[‚úÖ] 1. Mint test USDT to wallet
       - Function: mint(address to, uint256 amount)
       - Amount: 1000000000000000000000 (1000 USDT)
       - EXPECTED: ‚úÖ SUCCESS - Balance increases by 1000 USDT

[‚úÖ] 2. Check balance
       - Function: balanceOf(address)
       - EXPECTED: ‚úÖ SUCCESS - Returns correct balance

[‚úÖ] 3. Approve SignalFriendMarket to spend USDT
       - Function: approve(spender, amount)
       - Spender: 0x5133397a4B9463c5270beBa05b22301e6dD184ca
       - EXPECTED: ‚úÖ SUCCESS - Allowance set correctly

------------------------------------------------------------------------------
SIGNALFRIENDMARKET TESTS - JOIN AS PREDICTOR
------------------------------------------------------------------------------
[‚úÖ] 4. Join as Predictor (no referrer)
       - Pre-req: Approve 20 USDT first
       - Function: joinAsPredictor(address _referrer)
       - _referrer: 0x0000000000000000000000000000000000000000
       - Cost: 20 USDT
       - EXPECTED: ‚úÖ SUCCESS - Mints PredictorAccessPass NFT, Treasury receives 20 USDT

[‚úÖ] 5. Join as Predictor WITH valid referrer
       - Use a different wallet
       - Pre-req: Wallet A is already a predictor
       - Function: joinAsPredictor(walletA_address)
       - EXPECTED: ‚úÖ SUCCESS
         - New predictor gets NFT
         - Referrer (walletA) receives 5 USDT
         - Treasury receives 15 USDT

[‚úÖ] 6. Join as Predictor with INVALID referrer (non-predictor)
       - Function: joinAsPredictor(random_address)
       - EXPECTED: ‚úÖ SUCCESS (no revert)
         - Transaction succeeds, but NO referral payout
         - Full 20 USDT goes to treasury

[‚úÖ] 7. Join as Predictor with SELF as referrer
       - Function: joinAsPredictor(your_own_address)
       - EXPECTED: ‚úÖ SUCCESS (no revert)
         - Transaction succeeds, but NO referral payout
         - Full 20 USDT goes to treasury

[‚úÖ] 8. Try to join TWICE with same wallet
       - EXPECTED: ‚ùå REVERT with "AlreadyHasPredictorNFT"

------------------------------------------------------------------------------
SIGNALFRIENDMARKET TESTS - BUY SIGNAL
------------------------------------------------------------------------------
[‚úÖ] 9. Buy Signal NFT (basic purchase)
       - Pre-req: Approve 5.5 USDT (5 signal + 0.5 fee)
       - Function: buySignalNFT(_predictor, _signalPrice, _maxCommissionRate, _contentIdentifier)
       - _predictor: predictor wallet address
       - _signalPrice: 5000000000000000000 (5 USDT)
       - _maxCommissionRate: 500 (5%)
       - _contentIdentifier: 0x0000000000000000000000000000000000000000000000000000000000000001
       - EXPECTED: ‚úÖ SUCCESS
         - Mints SignalKeyNFT to buyer
         - Predictor receives 4.75 USDT (95%)
         - Treasury receives 0.75 USDT (5% + 0.5 fee)

[‚úÖ] 10. Buy Signal with HIGHER price (e.g., 10 USDT)
        - Pre-req: Approve 10.5 USDT
        - _signalPrice: 10000000000000000000 (10 USDT)
        - EXPECTED: ‚úÖ SUCCESS
          - Predictor receives 9.5 USDT
          - Treasury receives 1.0 USDT (0.5 + 0.5 fee)

[‚úÖ] 11. Buy Signal with price BELOW minimum (< 5 USDT)
        - _signalPrice: 1000000000000000000 (1 USDT)
        - EXPECTED: ‚ùå REVERT with "SignalPriceTooLow"

[‚úÖ] 12. Buy Signal from INVALID predictor (non-predictor address)
        - _predictor: random address with no NFT
        - EXPECTED: ‚ùå REVERT with "InvalidPredictor"

[‚úÖ] 13. Buy Signal from BLACKLISTED predictor
        - Pre-req: Blacklist a predictor first (see test #18)
        - EXPECTED: ‚ùå REVERT with "InvalidPredictor"

[‚úÖ] 14. Buy MULTIPLE signals (same content, different buyers)
        - Same contentIdentifier, different buyer wallets
        - EXPECTED: ‚úÖ SUCCESS - Each buyer gets unique tokenId, same contentIdentifier

[‚úÖ] 15. Buy Signal with INSUFFICIENT allowance
        - Approve only 4 USDT (less than 5.5 needed)
        - EXPECTED: ‚ùå REVERT with "InsufficientAllowance"

------------------------------------------------------------------------------
PREDICTORACCESSPASS TESTS - SOULBOUND
------------------------------------------------------------------------------
[‚è≥] 16. Try to TRANSFER PredictorAccessPass NFT
        - Function: transferFrom(from, to, tokenId)
        - EXPECTED: ‚ùå REVERT with "SoulboundTokenCannotBeTransferred"

[‚è≥] 17. Try to APPROVE PredictorAccessPass NFT
        - Function: approve(to, tokenId)
        - EXPECTED: ‚ùå REVERT with "SoulboundTokenCannotBeApproved"

------------------------------------------------------------------------------
PREDICTORACCESSPASS TESTS - BLACKLIST (MultiSig)
------------------------------------------------------------------------------
[‚è≥] 18. Blacklist a predictor
        - Signer 1: proposeSetBlacklist(predictorAddress, true)
        - Get actionId from logs
        - Signer 2: approveAction(actionId)
        - Signer 3: approveAction(actionId) ‚Üí auto-executes
        - EXPECTED: ‚úÖ SUCCESS
          - isBlacklisted(predictorAddress) = true
          - isPredictorActive(predictorAddress) = false

[‚è≥] 19. Unblacklist a predictor
        - Signer 1: proposeSetBlacklist(predictorAddress, false)
        - Signer 2 + 3: approveAction(actionId)
        - EXPECTED: ‚úÖ SUCCESS
          - isBlacklisted(predictorAddress) = false
          - isPredictorActive(predictorAddress) = true

[‚è≥] 20. Blacklisted predictor still OWNS their NFT
        - Check: balanceOf(blacklistedAddress)
        - EXPECTED: ‚úÖ Returns 1 (they still own NFT, just can't sell)

------------------------------------------------------------------------------
PREDICTORACCESSPASS TESTS - OWNER MINT (MultiSig)
------------------------------------------------------------------------------
[‚è≥] 21. Owner mint a free predictor pass
        - Signer 1: proposeOwnerMint(newPredictorAddress)
        - Signer 2 + 3: approveAction(actionId)
        - EXPECTED: ‚úÖ SUCCESS
          - balanceOf(newPredictorAddress) = 1
          - No USDT payment required

------------------------------------------------------------------------------
SIGNALKEYNFT TESTS - TRANSFERS
------------------------------------------------------------------------------
[‚è≥] 22. Transfer SignalKeyNFT to another wallet
        - Function: transferFrom(from, to, tokenId)
        - EXPECTED: ‚úÖ SUCCESS (SignalKeyNFT IS transferable)
          - ownerOf(tokenId) = new owner

[‚è≥] 23. Check contentIdentifier preserved after transfer
        - Function: getContentIdentifier(tokenId)
        - EXPECTED: ‚úÖ Returns same contentIdentifier as before transfer

------------------------------------------------------------------------------
METADATA URI TESTS (MultiSig)
------------------------------------------------------------------------------
[‚úÖ] 24. Update PredictorAccessPass metadata URI
        - Signer 1: proposeUpdateMetadataURI("ipfs://new-uri/")
        - Signer 2 + 3: approveAction(actionId)
        - EXPECTED: ‚úÖ SUCCESS - tokenURI(1) returns new URI

[‚úÖ] 25. Update SignalKeyNFT metadata URI
        - Same process on SignalKeyNFT contract
        - EXPECTED: ‚úÖ SUCCESS - tokenURI(1) returns new URI

------------------------------------------------------------------------------
PAUSE/UNPAUSE TESTS (MultiSig on SignalFriendMarket)
------------------------------------------------------------------------------
[‚è≥] 26. Pause the contract
        - Signer 1: proposePause()
        - Signer 2 + 3: approveAction(actionId)
        - EXPECTED: ‚úÖ SUCCESS - paused() = true

[‚è≥] 27. Try operations while paused
        - Try: joinAsPredictor()
        - EXPECTED: ‚ùå REVERT with "ContractCurrentlyPaused"
        - Try: buySignalNFT()
        - EXPECTED: ‚ùå REVERT with "ContractCurrentlyPaused"

[‚è≥] 28. Unpause the contract
        - Signer 1: proposeUnpause()
        - Signer 2 + 3: approveAction(actionId)
        - EXPECTED: ‚úÖ SUCCESS
          - paused() = false
          - Operations work again

------------------------------------------------------------------------------
VIEW FUNCTIONS (Read Contract Tab)
------------------------------------------------------------------------------
[‚è≥] 29. Check platform statistics
        - totalPredictorsJoined()
        - EXPECTED: ‚úÖ Returns correct count
        - totalSignalsPurchased()
        - EXPECTED: ‚úÖ Returns correct count
        - totalReferralsPaid()
        - EXPECTED: ‚úÖ Returns correct count

[‚è≥] 30. Check fee parameters
        - commissionRate()
        - EXPECTED: ‚úÖ Returns 500 (5%)
        - minSignalPrice()
        - EXPECTED: ‚úÖ Returns 5000000000000000000 (5 USDT)
        - predictorJoinFee()
        - EXPECTED: ‚úÖ Returns 20000000000000000000 (20 USDT)
        - buyerAccessFee()
        - EXPECTED: ‚úÖ Returns 500000000000000000 (0.5 USDT)
        - referralPayout()
        - EXPECTED: ‚úÖ Returns 5000000000000000000 (5 USDT)

[‚è≥] 31. Check predictor status
        - PredictorAccessPass: balanceOf(address)
        - EXPECTED: ‚úÖ Returns 1 for predictors, 0 for non-predictors
        - PredictorAccessPass: isPredictorActive(address)
        - EXPECTED: ‚úÖ Returns true for active, false for blacklisted/non-predictor
        - PredictorAccessPass: getPredictorTokenId(address)
        - EXPECTED: ‚úÖ Returns tokenId for predictors, reverts for non-predictors
        - PredictorAccessPass: isBlacklisted(address)
        - EXPECTED: ‚úÖ Returns true/false correctly

[‚è≥] 32. Check signal ownership
        - SignalKeyNFT: balanceOf(address)
        - EXPECTED: ‚úÖ Returns number of signals owned
        - SignalKeyNFT: tokensOfOwner(address)
        - EXPECTED: ‚úÖ Returns array of owned tokenIds
        - SignalKeyNFT: getContentIdentifier(tokenId)
        - EXPECTED: ‚úÖ Returns bytes32 contentIdentifier
        - SignalKeyNFT: totalMinted()
        - EXPECTED: ‚úÖ Returns total NFTs minted

================================================================================
                    ‚è≥ REMAINING TASKS
================================================================================

[‚è≥] 1. Complete all manual tests above (items 8-23, 26-32)

[‚úÖ] 2. Fix NFT metadata/image display issue
       - Updated URIs via MultiSig (proposeUpdateMetadataURI)
       - NFT images now display correctly

[‚è≥] 3. Integration Tests (Foundry)
       - Cross-contract scenarios
       - Full user journey tests
       - Edge cases with multiple users

[‚è≥] 4. Security/Fuzz Tests (Foundry)
       - Fuzz test payment calculations
       - Reentrancy attack simulations
       - Overflow/underflow checks

[‚è≥] 5. Gas Profiling
       - forge test --gas-report
       - Identify optimization opportunities

[‚è≥] 6. Professional Audit (Optional)
       - Consider for mainnet launch

[‚è≥] 7. Deploy to BNB Mainnet
       - Set IS_TESTNET = false in Deploy.s.sol
       - Use real USDT address
       - Complete Phase 2 MultiSig setup

================================================================================
                    üìù NOTES
================================================================================

- Always run `source .env` before any commands
- Each MultiSig action expires in 1 hour
- Treasury wallet receiving fees: 0xc21Ca5BA47cF1C485DE33b26D9Da3d10ACcDa413
- See RUNBOOK.md for detailed step-by-step instructions
